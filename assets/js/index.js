// Generated by CoffeeScript 1.9.0
$(function() {
  var $body, choices, choicesFrame, drops, dropsFrame;
  $body = $("body");
  dropsFrame = $(".drops");
  choicesFrame = $(".choices");
  drops = $(".drop");
  choices = $(".choice");
  choices.on("click", function(event) {
    var choice, choiceParent;
    event.stopPropagation();
    choice = $(this);
    choiceParent = choice.parent();
    choicesFrame.removeClass("receiving");
    drops.removeClass("receiving");
    if (choice.hasClass("active")) {
      return choice.removeClass("active");
    } else {
      choices.removeClass("active");
      choice.addClass("active");
      drops.not(choiceParent).addClass("receiving");
      if (choiceParent.hasClass("drop")) {
        return choicesFrame.addClass("receiving");
      }
    }
  });
  $body.on("click", ".receiving", function(event) {
    var activeChoice, frame;
    frame = $(this);
    activeChoice = choices.filter(".active");
    if (activeChoice.length === 0) {
      return;
    }
    activeChoice.trigger("dropping");
    return frame.trigger("receiving", [activeChoice]);
  });
  choices.on("dropping", function() {
    var choice;
    choice = $(this);
    choice.removeClass("active");
    choicesFrame.removeClass("receiving");
    return drops.removeClass("receiving");
  });
  dropsFrame.on("receiving", ".drop", function(event, choice) {
    var childChoice, choiceParent, frame;
    frame = $(this);
    childChoice = frame.find(".choice");
    choiceParent = choice.parent();
    if (choiceParent.hasClass("drop")) {
      choiceParent.append(childChoice);
    } else {
      choicesFrame.trigger("receiving", [childChoice]);
    }
    return frame.append(choice);
  });
  choicesFrame.on("receiving", function(event, choice) {
    var frame;
    frame = $(this);
    frame.append(choice);
    return frame.find(".choice").sort(function(a, b) {
      var x, y;
      x = $(a).data("order");
      y = $(b).data("order");
      if (x < y) {
        return -1;
      } else {
        return 1;
      }
    }).detach().appendTo(frame);
  });
  choices.on("mouseover", function(event) {
    return event.stopPropagation();
  });
  choicesFrame.on("mouseover", function() {
    var frame;
    frame = $(this);
    return frame.addClass("hover");
  });
  return choicesFrame.on("mouseout", function() {
    var frame;
    frame = $(this);
    return frame.removeClass("hover");
  });
});
